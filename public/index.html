<!DOCTYPE html>
<html>
<head>
  <title>Bigin Products</title>
  <script src="https://js.zohocdn.com/biginsdk/dist/js/bigin-widget-sdk.js"></script>
</head>
<body>
  <h2>Zoho Bigin Products</h2>
  <div id="status">Loading...</div>

  <script>
    ZOHO.embeddedApp.init().then(() => {
      fetch('/products')
        .then(res => res.json())
        .then(data => {
          const cleanData = (data.data || []).map(p => ({
            "Product Name": p.Product_Name || "N/A",
            "Category": p.Product_Category || "Uncategorized",
            "Price": p.Unit_Price ?? "0"
          }));

          ZBWidget.set({
            type: "list",
            data: cleanData
          });

          document.getElementById("status").innerText = "Products loaded!";
        })
        .catch(err => {
          document.getElementById("status").innerText = "Failed to load products.";
          console.error(err);
        });
    });
  </script>
</body>
</html>
